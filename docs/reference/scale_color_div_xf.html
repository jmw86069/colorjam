<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Continuous divergent color scale for ggplot2, with max and optional floor — scale_color_div_xf • colorjam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Continuous divergent color scale for ggplot2, with max and optional floor — scale_color_div_xf"><meta name="description" content="Continuous divergent color scale for ggplot2, with max and optional floor"><meta property="og:description" content="Continuous divergent color scale for ggplot2, with max and optional floor"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">colorjam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.34.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmw86069/colorjam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Continuous divergent color scale for ggplot2, with max and optional floor</h1>
      <small class="dont-index">Source: <a href="https://github.com/jmw86069/colorjam/blob/HEAD/R/colorjam-scale-color-div-xf.R" class="external-link"><code>R/colorjam-scale-color-div-xf.R</code></a></small>
      <div class="d-none name"><code>scale_color_div_xf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Continuous divergent color scale for ggplot2, with max and optional floor</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scale_color_div_xf</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  floor <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lens <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  colramp <span class="op">=</span> <span class="st">"RdBu_r"</span>,</span>
<span>  open_floor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  floor_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  guide <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  aesthetics <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scale_fill_div_xf</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  floor <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lens <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  colramp <span class="op">=</span> <span class="st">"RdBu_r"</span>,</span>
<span>  open_floor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  floor_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  guide <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  aesthetics <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>numeric</code> with the value at or above which the maximum color
is applied. Default is 1.</p></dd>


<dt id="arg-floor">floor<a class="anchor" aria-label="anchor" href="#arg-floor"></a></dt>
<dd><p><code>numeric</code>, default NULL, with the numeric floor, the value
at or above which the first color is applied.
This threshold may be suitable when coloring P-values for example,
to define a floor at the P-value threshold for statistical significance.</p></dd>


<dt id="arg-lens">lens<a class="anchor" aria-label="anchor" href="#arg-lens"></a></dt>
<dd><p><code>numeric</code> value, default 0, used to adjust the color intensity,
by increasing the rate of color change along the color gradient.
Positive values increase intensity, negative values decrease intensity.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>integer</code> number of intermediate steps used to define color
breaks, passed to <code><a href="col_div_xf.html">col_div_xf()</a></code>. Default 15.</p></dd>


<dt id="arg-colramp">colramp<a class="anchor" aria-label="anchor" href="#arg-colramp"></a></dt>
<dd><p><code>character</code> recognized by <code><a href="https://jmw86069.github.io/jamba/reference/getColorRamp.html" class="external-link">jamba::getColorRamp()</a></code>,
default 'RdBu_r' is the RColorBrewer divergent palette 'RdBu'
which is reversed to blue-white-red.
This argument generally accepts one of the following:</p><ul><li><p>name of a divergent color ramp from RBrewerColors</p></li>
<li><p>single color, which generates a divergent gradient using a
complementary color for the opposing direction</p></li>
<li><p>vector of colors, used to generate a full gradient</p></li>
</ul></dd>


<dt id="arg-open-floor">open_floor<a class="anchor" aria-label="anchor" href="#arg-open-floor"></a></dt>
<dd><p><code>logical</code> default FALSE, whether to apply gradient
colors to values below the floor. Generally FALSE is recommended,
but TRUE is useful to have some visual indication that there are
non-empty values, and can be a viable option in some cases.</p></dd>


<dt id="arg-floor-color">floor_color<a class="anchor" aria-label="anchor" href="#arg-floor-color"></a></dt>
<dd><p><code>character</code> color, default NULL, used when <code>floor</code>
is defined. When <code>open_floor=FALSE</code> the <code>floor_color</code> is applied
as a solid color to all values below the floor. When <code>open_floor=TRUE</code>
the <code>floor_color</code> is used to define a gradient which is applied
up to the floor (and not including the floor value).</p></dd>


<dt id="arg-guide">guide<a class="anchor" aria-label="anchor" href="#arg-guide"></a></dt>
<dd><p><code>GuideLegend</code> object used by ggplot2 to customize the
guide displayed in the legend. Default simply sets the guide legend
values to be reversed, so that higher numeric values appear at
the top of the legend.</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>default NULL uses the breaks and labels defined by
<code><a href="col_div_xf.html">col_div_xf()</a></code>, otherwise suggested <code><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">ggplot2::waiver()</a></code> to use its
default.</p></dd>


<dt id="arg-hjust">hjust<a class="anchor" aria-label="anchor" href="#arg-hjust"></a></dt>
<dd><p><code>numeric</code> used to define horizontal justification of numeric
labels. Default 1 uses right-alignment.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are passed to <code><a href="https://ggplot2.tidyverse.org/reference/continuous_scale.html" class="external-link">ggplot2::continuous_scale()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code><a href="https://ggplot2.tidyverse.org/reference/Scale.html" class="external-link">ggplot2::ScaleContinuous</a></code> object which inherits <code>ggproto</code>,
suitable to use in ggplot2 composition.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is intended to provide ggplot2 color scales
using the same logic applied in <code><a href="col_div_xf.html">col_div_xf()</a></code>.
Specifically, it applies a maximum numeric value to the color range,
and an optional numeric floor.</p>
<p>Other enhancements:</p><ul><li><p>The ggplot2 legend shows discrete steps with labels for each color.
This style differs from ggplot2 "colorsteps" which labels the break
between colors.</p></li>
</ul><p>The maximum numeric color value is useful for plots that have
a known "practical" range of numeric values.
For example, correlation values range from -1 to +1. Some data may
contain values between -0.2 and +0.5. Using a "min-max" gradient,
the midpoint would be 0.15, and may therefore place the middle
("white" or "black") divergent color at 0.15 instead of 0.0.
Further, the color range might extend to 0.5 instead of 1.0.</p>
<p>Similarly, gene expression data is often represented in log2 scale,
centered versus a control group, or versus the mean expression
for each gene. The practical range might be -5 to +5 in log2 space,
which represents -32 to +32 fold in normal space. We argue that
changes at or above 32-fold are often adequate to represent with the
"max color". Similarly, when changes do not reach 32-fold, it is
often helpful to show a consistent color scale that spans 32-fold
anyway, so that smaller values are seen with similar visual context.</p><div class="section">
<h3 id="future-ideas">Future ideas<a class="anchor" aria-label="anchor" href="#future-ideas"></a></h3>

<ul><li><p>Support custom numeric positions, and numeric labels.</p></li>
<li><p>Consider using the numeric breaks defined by <code><a href="col_div_xf.html">col_div_xf()</a></code>.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other colorjam ggplot2:
<code><a href="scale_color_jam.html">scale_color_jam</a>()</code>,
<code><a href="scale_color_linear_xf.html">scale_color_linear_xf</a>()</code>,
<code><a href="scale_fill_jam.html">scale_fill_jam</a>()</code>,
<code><a href="theme_jam.html">theme_jam</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mtcars2</span> <span class="op">&lt;-</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/mtcars.html" class="external-link">mtcars</a></span>;</span></span>
<span class="r-in"><span><span class="va">mtcars2</span><span class="op">$</span><span class="va">hpctr</span> <span class="op">&lt;-</span> <span class="va">mtcars2</span><span class="op">$</span><span class="va">hp</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mtcars2</span><span class="op">$</span><span class="va">`log2 centered hp`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars2</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, colour<span class="op">=</span><span class="va">hpctr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">scale_color_div_xf</span><span class="op">(</span>x<span class="op">=</span><span class="fl">100</span>, floor<span class="op">=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="theme_jam.html">theme_jam</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="scale_color_div_xf-1.png" alt="" width="768" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars2</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, fill<span class="op">=</span><span class="va">`log2 centered hp`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span>, shape<span class="op">=</span><span class="fl">21</span>, color<span class="op">=</span><span class="st">"#00000033"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">scale_fill_div_xf</span><span class="op">(</span>x<span class="op">=</span><span class="fl">2</span>, lens<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="theme_jam.html">theme_jam</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="scale_color_div_xf-2.png" alt="" width="768" height="768"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/faithfuld.html" class="external-link">faithfuld</a></span>,</span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">waiting</span>, <span class="va">eruptions</span>, fill<span class="op">=</span><span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">scale_fill_div_xf</span><span class="op">(</span><span class="fl">0.04</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="theme_jam.html">theme_jam</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="scale_color_div_xf-3.png" alt="" width="768" height="768"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

